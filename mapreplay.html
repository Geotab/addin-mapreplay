<!DOCTYPE html>
<html>
<head>
    <title>Map Replay</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
    <div id="mapreplay-map"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.js"></script>
    <script type="text/javascript">
        geotab.addin.mapreplay = function(api, state) {
            var map;

            var initializeMap = function () {
                // Initialize the map container

                map = new L.Map("mapreplay-map").on("load", function () {
                    setTimeout(function () {
                        map.invalidateSize();
                    }, 500);
                }).setView([43.436884, -79.711760], 15);

                // Add the map tiles layer

                L.tileLayer("https://otile{s}-s.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.png", {
                    subdomains: "1234",
                    type: "osm",
                    attribution: "Data, imagery and map information provided by <a href='http://www.mapquest.com/'  target='_blank'>MapQuest</a>, <a href='http://www.openstreetmap.org/' target='_blank'>Open Street Map</a> and contributors, <a href='http://creativecommons.org/licenses/by-sa/2.0/' target='_blank'>CC-BY-SA</a>  <img src='http://developer.mapquest.com/content/osm/mq_logo.png' border='0'>",
                    maxZoom: 18
                }).addTo(map);
            };

            return {
                /*
                 * Page lifecycle method: initialize is called once when the addin first starts
                 * Use this function to initialize the addin's state such as default values or
                 * make API requests (Geotab or external) to ensure interface is ready for the user.
                 */
                initialize: function(api, state, callback) {
                    // Initialize the map
                    initializeMap();

                    // Must be called to let the app know that we've initialized the addon
                    callback();
                },
                
                /*
                 * Page lifecycle method: focus is called when the page has finished initialize method
                 * and again when a user leaves and returns to your addin that has already been initialized.
                 * Use this function to refresh state such as vehicles, zones or exceptions which may have
                 * been modified since it was first initialized.
                 */      
                focus: function() {
                },
                
                /*
                 * Page lifecycle method: blur is called when the user is leaving your addin.
                 * Use this function to save state or commit changes to a datastore or release memory.
                 */
                blur: function() {
                }
            };
        };
    </script>
</body>
</html>